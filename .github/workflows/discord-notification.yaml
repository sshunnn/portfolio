name: Notify Discord on Push

on:
  push:
    branches:
      - main # 通知を送信したいブランチを指定

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        
      - name: Send Discord Notification
        run: |
          curl -H "Content-Type: application/json" \
               -d "{
                 \"embeds\": [
                   {
                     \"title\": \"🚀 ポートフォリオがデプロイされました！\",
                     \"description\": \"新しい変更がVercelにデプロイされました。\",
                     \"color\": 5814783,
                     \"fields\": [
                       {
                         \"name\": \"👤 更新者\",
                         \"value\": \"\`${{ github.actor }}\`\",
                         \"inline\": true
                       },
                       {
                         \"name\": \"🌿 ブランチ\",
                         \"value\": \"\`${{ github.ref_name }}\`\",
                         \"inline\": true
                       },
                       {
                         \"name\": \"📝 コミットメッセージ\",
                         \"value\": \"${{ github.event.head_commit.message }}\",
                         \"inline\": false
                       },
                       {
                         \"name\": \"🔗 デプロイURL\",
                         \"value\": \"[ポートフォリオを見る](https://portfolio-sshunnns-projects.vercel.app/)\",
                         \"inline\": false
                       }
                     ],
                     \"timestamp\": \"${{ github.event.head_commit.timestamp }}\",
                     \"footer\": {
                       \"text\": \"GitHub Actions\",
                       \"icon_url\": \"https://github.githubassets.com/images/modules/logos_page/GitHub-Mark.png\"
                     }
                   }
                 ]
               }" \
               ${{ secrets.DISCORD_WEBHOOK_URL }}